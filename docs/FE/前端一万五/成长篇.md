--- 
title: 前端一万五 - 成长篇
date: 2019-12-11
sidebar: 'auto'
categories: 
 - 前端一万五
tags: 
 - 踩坑
 - knowledge
publish: true
---

日常踩坑记录篇，记录项目中遇到的一些小知识点

<!-- more -->

## Javascript/TypeScript

### 循环和async的奇妙组合

```js
const list = [1, 2, 3]

async function foo() {
  return false
}

const data = list.every(async () => {
  console.log('start')
  const result = await foo()
  console.log('end')
  return result
})
console.log('JSLog: data', data) // ？

```

如果想连续执行await调用，请使用for循环(或任何没有回调的循环)，推荐for-of替代

### 循环引用

```js
// a.js

const b = require('./b')

b.getB()

const getA = () => {
  console.log('getA')
}

module.exports = {
  getA
}

// b.js

const a = require('./a')

a.getA()

const getB = () => {
  console.log('getB')
}

module.exports = {
  getB
}
```

`a`模块和`b`模块之间互相引用调用函数，将导致异常

### 判断数据类型的封装

```js
const TYPES = [
  'Boolean',
  'Number',
  'String',
  'Function',
  'Array',
  'Date',
  'RegExp',
  'Object',
  'Error'
]

export default TYPES.reduce((acc, item) => {
  acc[`is${item}`] = obj => {
    return Object.prototype.toString.call(obj) === `[object ${item}]`
  }
  return acc
}, {})
```

### promisify.js

```js
export default api => {
  return (options, ...params) => {
    return new Promise((resolve, reject) => {
      api(Object.assign({}, options, { success: resolve, fail: reject }), ...params)
    })
  }
}
```
